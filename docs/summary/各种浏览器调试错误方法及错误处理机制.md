# 各个浏览器调试错误工具

> JavaScript高级程序设计，第17章
## IE调试错误

## Firefox

## Safari的开发菜单

* 开启方法
1. 运行Safari,点击“Safari”菜单下面的“偏好设置（Preferences...）”，切换到“高级选项（Advanced）”：
勾选在菜单栏中显示开发菜单
    ![jpg](./images/10.png)

2. 勾选“在菜单栏显示"开发"菜单（ShowDevelop menu in menu bar）”，关闭偏好设置。此时在Safari的工具栏出现“开发（Develop）”菜单：

    ![jpg](./images/13.png)

## Opera

# 错误处理

## try catch
```js
try {
  // 可能会导致错误的代码
  console.g('d')
} catch (err) {
  // 在错误发生时怎么处理
  console.log(err.name);
  console.log(err.message);
}
```

## finally子句

* 只要代码中包含了finally子句，无论是try或catch语句快中的return都将被忽略
```js
try{
}catch(err){
}finally{
}
```

## 错误类型
* 执行代码期间可能会发生的错误类型有多种类型。每种错误都有对应的错误类型。而当错误发生时，就会抛出相应类型的错误对象。ECMA-262定义了下列7中错误类型：

1. Error  // 基类型，其他错误类型都继承自该类型。因此所有错误类型共享一组相同的属性。Error类型的错误很少见，如果有，也是浏览器抛出的；这个基类型的主要目的是供开发人员抛出自定义错误。
2. EvalError  // 在 eval 函数发生异常时抛出。可能性小：没有把eval当作函数调用，会抛错。
3. RangeError // 数组超出相应范围时触发，经常出现这种错误。例：定义数组时，指定例不支持的项数(如 -20 或者Number.MAX_VALUE)，就会触发 new Array(-20) , newArray(Number.MAX_VALUE)
4. ReferenceError  // 通常在访问不存在的变量时，会发生这种错误如 var obj = x；
5. SyntaxError  // 把语法错误的JavaScript字符串传入 eval()函数时，就会导致此类错误。不常出现
6. TypeError  // 在变量中保存着意外的类型时，或者在访问不存在的方法时，都会导致这种错误例：var o = new 10; alert('name' in true)
7. URIError // 在使用 encodeURI() 或 decodeURI()，而URI 格式不正确时 ，错误很少见，因为这两个函数容错性高


## 抛出错误

throw 操作符，用于随时抛出自定义错误。抛出错误时，必须要给 throw 操作符指定一个值，这个值是什么类型，没有要求。下列代码都是有效的

```js
throw 12345
throw 'hello world'
throw true;
throw {name: 'javascript'}
```

在遇到 throw 操作符时，代码会立即停止执行。仅当有 try-catch 语句捕获到被抛出的值时，代码才会执行

通过使用某种内置错误类型，可以更真是的模拟浏览器错误。每种错误类型的构造函数接收一个参数，即实际的错误消息。下面例子

```js
throw new Error('Something bad happened');
```

利用原型链还可以通过继承 Error 来创建自定义错误类型。此时需要为新创建的类型指定 name 和 message 属性

```js
function InvalidUrlError(message) {
    this.name = 'InvalidUrlError';
    this.message = message;
}
InvalidUrlError.prototype = new Error();

throw new InvalidUrlError('参数错误：404')

```

*IE只有在抛出 Error 对象时，才会显示自定义错误消息。对于其他类型，它都无一例外都显示"exception thrown and not caught"（抛出了一场，且未被捕获）*

* 我们只应该捕获那些你确切的知道该如何处理的错误。`捕获错误`的目的在于避免浏览器以默认方式处理它们，而`抛出错误`的目的在于提供错误发生具体原因的消息。

## 错误（error）事件

任何没有通过 try-catch 处理的错误都会触发 window 对象的 error 事件。IE,Firefox ,Chrome 保持向后兼容，并没有对这个事件作任何修改（Opera 和 Safari 不支持 error 事件）

```js
window.onerror = function (message, url, line) {
    // 错误消息、错误所在url、错误所在第行号
    alert(message);
    return false; // 可以阻止浏览器默认行为
}
```
 图像也支持 error 事件。只要图像的 src 特性中的 URL 不能返回可以被识别的图像格式，就会触发 error 事件。此时的 error 事件遵循 DOM 格式，会返回一个以图像为目标的 event 对象。

```js
var image = new Image();
EventUtil.addHandler(image, 'load', function (event) {
    alert('Image loaded!')
})
EventUtil.addHandler(image, 'error', function (event) {
    alert('Image not loaded!')
})

image.src= 'smilex.gif'
```

## 处理错误策略

例如；记录和监控系统。这些攻击的用途在于分析错误模式，追查错误原因，同时帮助确定错误会影响多少用户。

## 常见的错误类型

* 类型转换错误
* 数据类型错误
* 通信错误

### 类型转换错误

类型转换错误发生在使用某个操作符，或者使用其他可能会自动转换值的数据类型的语言结构时，在使用相等（==）和不相等（！=）操作符，或者在if、for及 while 等流控制语句中使用非布尔值时，最常发生类型转换错误。

建议使用全等，if中建议使用typeof 而不是直接if(value){}

### 数据类型错误

JavaScript 是松散类型的，也就是说，在使用变量和函数参数之前，不会对它们进行比较以确保它们对数据类型正确。为了保证不会发生数据类型错误，只能依靠开发人员便携适当的数据类型检测代码。在将预料之外的值传递给函数的情况下，最容易发生数据类型错误。

大体来说，基本类型的值应该使用 typeof 来检测，而对象的值则应该使用 instanceof 来检测。根据使用函数的方式，有时候并不需要逐个检测所有参数的数据类型。但是，面向公众的 API 则必须无条件地执行类型检查，以确保函数能够正常的执行。

### 通信错误























